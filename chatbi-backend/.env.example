# ===========================================
# ChatBI 后端环境配置示例
# 复制此文件为 .env 并填入实际值
# Author: CYJ
# ===========================================

# ===========================================
# 项目基础配置
# ===========================================
PROJECT_NAME="ChatBI Backend"
VERSION="0.1.0"
API_V1_STR="/api/v1"

# ===========================================
# 服务器配置
# ===========================================
SERVER_HOST=0.0.0.0
SERVER_PORT=7000
DEBUG_MODE=true

# ===========================================
# WebSocket / Chat 配置
# ===========================================
CHAT_SESSION_EXPIRE_SECONDS=3600
CHAT_MESSAGE_MAX_LENGTH=500
CHAT_MAX_CONCURRENT_REQUESTS=10
CHAT_STORAGE_TYPE=memory

# WebSocket 连接配置 (0=禁用自动ping，避免LLM调用期间超时)
WS_PING_INTERVAL=0
WS_PING_TIMEOUT=0
WS_CLOSE_TIMEOUT=10

# 应用层心跳
WS_HEARTBEAT_INTERVAL=30
WS_HEARTBEAT_TIMEOUT=90

# ===========================================
# 连接与限流配置
# ===========================================
# WebSocket 最大连接数
WS_MAX_CONNECTIONS=5
# LLM 最大并发调用数（超过此值会排队等待）
LLM_MAX_CONCURRENT_CALLS=10

# ===========================================
# Database - MySQL (业务数据库)
# 用途: BI 查询的数据源
# ===========================================
MYSQL_HOST=localhost
MYSQL_PORT=3306
MYSQL_USER=your_mysql_user
MYSQL_PASSWORD=your_mysql_password
MYSQL_DB=chatbi

# ===========================================
# Database - MySQL (系统数据库：用户、日志等)
# ===========================================
SYS_DB_HOST=localhost
SYS_DB_PORT=3306
SYS_DB_USER=your_sys_db_user
SYS_DB_PASSWORD=your_sys_db_password
SYS_DB_NAME=chatbi_sys

# ===========================================
# Database - Vector (PostgreSQL + pgvector)
# 用途: Schema 嵌入向量存储，支持语义检索
# ===========================================
VECTOR_DB_HOST=localhost
VECTOR_DB_PORT=5432
VECTOR_DB_USER=postgres
VECTOR_DB_PASSWORD=your_pg_password
VECTOR_DB_NAME=chatbi_pg

# ===========================================
# Database - Neo4j
# 用途: 知识图谱，表与表关系、业务概念
# ===========================================
NEO4J_URI=bolt://localhost:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=your_neo4j_password

# ===========================================
# LLM Configuration
# 支持: kimi / dashscope / openai
# ===========================================
LLM_PROVIDER=kimi

# Kimi (Moonshot AI) 配置
LLM_KEY=your_kimi_api_key
LLM_MODEL=kimi-k2-0905-preview
LLM_BASE_URL=https://api.moonshot.cn/v1

# 阿里云通义千问配置 (用于 Embedding)
DASHSCOPE_API_KEY=your_dashscope_api_key
DASHSCOPE_EMBEDDING_MODEL=text-embedding-v3

# OpenAI 配置（备用）
OPENAI_API_KEY=
OPENAI_BASE_URL=https://api.openai.com/v1

# ===========================================
# LLM 温度配置
# ===========================================
LLM_TEMPERATURE_PRECISE=0.0
LLM_TEMPERATURE_CREATIVE=0.7
LLM_TEMPERATURE_BALANCED=0.3
LLM_TEMPERATURE_RESPONSE=0.5

# ===========================================
# 检索配置 (Retrieval)
# ===========================================
RETRIEVAL_HIGH_THRESHOLD=0.55
RETRIEVAL_MEDIUM_THRESHOLD=0.50
RETRIEVAL_LOW_THRESHOLD=0.45
RETRIEVAL_VECTOR_WEIGHT=0.4
RETRIEVAL_DEFAULT_TOP_K=10

# ===========================================
# 缓存配置 (Cache)
# ===========================================
CACHE_SCORE_THRESHOLD=80
